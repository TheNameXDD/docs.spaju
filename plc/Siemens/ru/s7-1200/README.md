# S7-1200

### О программировании ПЛК <a href="#about-plc-programming" id="about-plc-programming"></a>

Все программируемые логические контроллеры должны отвечать стандарту **IEC 61131**. Такие контроллеры программируются с помощью специального программного обеспечения, и с помощью специализированных языков программирования. Описание таких языков программирования можно найти в стандарте **IEC 61131-2**.&#x20;

{% hint style="info" %}
**IEC - International Electrotechnical Commission** (Международная электротехническая комиссия). Это международная некоммерческая организация в области  электрических, электронных и смежных технологий, которая занимается стандартизацией.
{% endhint %}

На момент **2023** всего в стандарте **IEC 61131-2** описано **5** языков программирования для ПЛК:

* **LD** (Ladder Diagram) - графический язык программирования
* **FBD** (Function Block Diagram) - графический язык программирования
* **SFC** (Sequential Function Chart) - графический язык программирования
* **ST** (Structured Text) - текстовый язык программирования
* **IL** (Instruction List) - текстовый язык программирования

### Принцип работы ПЛК Siemens SIMATIC S7-1200 <a href="#siemens-plc-work-principle" id="siemens-plc-work-principle"></a>

У контроллера S7-1200 есть 3 режима работы CPU (центральный процессор контроллера):

* **STOP**
* **STARTUP**
* **RUN**

{% hint style="info" %}
**CPU** выполняет следующие задачи: 1) записывает входы из области выходов образа процесса в физические выходы 2) считывает физические входы непосредственно перед исполнением программы пользователя и сохраняет значения входов в области входов образа процесса 3) выполняет логику команд пользователя и обновляет значения выходов в области выходов образа процесса
{% endhint %}

В режиме **STOP** CPU не выполняет программу и позволяет загружать проект из TIA portal.&#x20;

В режиме **STARTUP** один раз выполняются OB (организационный блок) запуска (если такие имеются). События, связанные с прерываниями, на этапе запуска режима **RUN** не обрабатываются.&#x20;

В режиме **RUN** многократно выполняется цикл сканирования. События, связанные с прерываниями, могут возникнуть и быть обработаны в любых точках внутри программного цикла. В режиме **RUN** нет возможности загрузить проект из TIA portal.&#x20;

### Переход из режима STOP в режим RUN <a href="#plc-startup" id="plc-startup"></a>

<figure><img src="../../../../.gitbook/assets/S7_CPU_stop2run.png" alt=""><figcaption></figcaption></figure>

Во время перехода из режима **STOP** в режим **RUN** контроллер проходит дополнительное через режим **STARTUP**.&#x20;

Режим **STARTUP**:

**A:** Очищается область памяти входов (I)

**B:** Выходы инициализируются последним или заменяющим значением

**C:** Исполняются организационные блоки (OB) запуска

**D:** Состояние физических входов копируется в область памяти входов (I)

**E:** Все события, связанные с прерываниями, сохраняются в очереди ожидания для обработки в режиме RUN

**F:** Активируется запись области памяти выходов (Q) в физические выходы

{% hint style="info" %}
Специальные организационные блоки (OB), которые запускаются единожды во время режима STARTUP в TIA portal называются **Startup interrupt**.
{% endhint %}

Режим RUN:

**1:** Область памяти Q записывается в физические выходы

**2:** Состояние физических входов копируется в область памяти I

**3:** Исполняются OB программного цикла

**4:** Выполняется самодиагностика

**5:** Во всех частях цикла обрабатываются прерывания и коммуникации

{% hint style="info" %}
У контроллеров S7 существуют так называемые "блоки прерываний". Это особые блоки выполняются только при определенных условиях (например: раз за определенный промежуток времени, во время физического сигнала на один из входов на контроллер и т.д.).
{% endhint %}

